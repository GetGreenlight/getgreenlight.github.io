<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Support & Setup - Greenlight</title>
  <meta name="description" content="Get started with Greenlight. Installation instructions, setup guide, and support for remote AI agent approval.">
  <link rel="icon" type="image/png" href="greenlight-logo-1024.png">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav>
    <div class="container">
      <a href="/" class="brand">
        <img src="greenlight-logo-1024.png" alt="Greenlight logo">
        Greenlight
      </a>
      <div class="nav-links">
        <a href="/">Home</a>
        <a href="guide-claude-code.html">Claude Code Guide</a>
        <a href="guide-windsurf.html">Windsurf Guide</a>
      </div>
    </div>
  </nav>

  <div class="docs">
    <div class="container">
      <h1>Support & Setup Guide</h1>

      <h2>Getting Started</h2>
      <p>For a more detailed walkthrough including how the rules system works, see the <a href="guide-claude-code.html">Claude Code setup guide</a>.</p>

      <h3>Prerequisites</h3>
      <p>The hook scripts require <code>jq</code> and <code>curl</code> to be installed on your machine. These are pre-installed on most macOS and Linux systems. To check:</p>
      <pre><code>jq --version
curl --version</code></pre>
      <p>If either is missing, install via your package manager (e.g., <code>brew install jq</code> on macOS, <code>apt install jq</code> on Ubuntu/Debian).</p>

      <h3>1. Install the App</h3>
      <p>Download Greenlight from the App Store and open it. The app will automatically generate a unique device ID and connect to the relay server.</p>

      <h3>2. Copy Your Device ID</h3>
      <p>Go to the <strong>About</strong> tab in the app and tap your Device ID to copy it to the clipboard. You'll need this for the next step.</p>

      <h3>3. Install the Hook Script</h3>
      <p>Download the hook script and place it somewhere on your machine:</p>
      <pre><code>curl -o ~/greenlight-hook.sh https://getgreenlight.github.io/greenlight-hook.sh
chmod +x ~/greenlight-hook.sh</code></pre>

      <h3>4. Configure Claude Code</h3>
      <p>Add a hook to your Claude Code <strong>per-project</strong> settings file (<code>.claude/settings.local.json</code> in your project root):</p>
      <pre><code>{
  "hooks": {
    "PermissionRequest": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "~/greenlight-hook.sh --device-id YOUR_DEVICE_ID --project myproject"
          }
        ]
      }
    ],
    "Notification": [
      {
        "matcher": "idle_prompt",
        "hooks": [
          {
            "type": "command",
            "command": "~/greenlight-hook.sh --device-id YOUR_DEVICE_ID --project myproject"
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "matcher": "",
        "hooks": [
          {
            "type": "command",
            "command": "~/greenlight-hook.sh --device-id YOUR_DEVICE_ID --project myproject"
          }
        ]
      }
    ]
  }
}</code></pre>
      <p>Replace <code>YOUR_DEVICE_ID</code> with the device ID from the app, and <code>myproject</code> with your project's name. The <code>--project</code> flag is required &mdash; it names the project in the app and scopes rules per-project.</p>
      <p>The <code>Notification</code> hook sends a push notification when Claude is idle and waiting for input. The <code>UserPromptSubmit</code> hook starts the activity streamer as soon as you submit a prompt, so you can watch Claude work in real time (Greenlight Pro). Both are optional but recommended.</p>
      <p>The first time a new Claude Code session runs, it will register with your phone. Tap <strong>Allow</strong> on the enrollment prompt to approve it.</p>
      <p><strong>Important:</strong> Do not add the hook to your global configuration (<code>~/.claude/settings.json</code>). Claude Code merges global and project settings, so having the hook in both places will send two requests for every action.</p>

      <h3>5. Test It</h3>
      <p>Run Claude Code and ask it to do something that requires permission:</p>
      <pre><code>claude "list files in /etc"</code></pre>
      <p>You should see a request appear in the app!</p>

      <h2>Windsurf (Cascade) Setup</h2>
      <p>Greenlight also supports <a href="https://windsurf.com">Windsurf</a> via its Cascade Hooks system. For a more detailed walkthrough, see the <a href="guide-windsurf.html">Windsurf setup guide</a>.</p>

      <h3>1. Install the Windsurf Hook Script</h3>
      <p>Download the Windsurf-specific hook script:</p>
      <pre><code>curl -o ~/greenlight-windsurf.sh https://getgreenlight.github.io/greenlight-windsurf.sh
chmod +x ~/greenlight-windsurf.sh</code></pre>

      <h3>2. Configure Windsurf Hooks</h3>
      <p>Create or edit the hooks configuration file at <code>~/.codeium/windsurf/hooks.json</code>:</p>
      <pre><code>{
  "hooks": {
    "pre_run_command": [{
      "command": "~/greenlight-windsurf.sh --device-id YOUR_DEVICE_ID",
      "show_output": true
    }],
    "pre_write_code": [{
      "command": "~/greenlight-windsurf.sh --device-id YOUR_DEVICE_ID",
      "show_output": true
    }],
    "pre_read_code": [{
      "command": "~/greenlight-windsurf.sh --device-id YOUR_DEVICE_ID",
      "show_output": true
    }],
    "pre_mcp_tool_use": [{
      "command": "~/greenlight-windsurf.sh --device-id YOUR_DEVICE_ID",
      "show_output": true
    }]
  }
}</code></pre>
      <p>Replace <code>YOUR_DEVICE_ID</code> with the device ID from the app. The project name is detected automatically from the working directory or git repository root.</p>
      <p>You can also place a <code>.windsurf/hooks.json</code> file in a project directory for per-project configuration.</p>

      <h3>3. Test It</h3>
      <p>Open a project in Windsurf, start a Cascade session, and ask it to run a command or edit a file. You should see the request appear in the app with a <strong>windsurf</strong> badge.</p>

      <h2>Hook Script Options</h2>
      <p>Both hook scripts support the same options:</p>
      <table>
        <thead>
          <tr>
            <th>Option</th>
            <th>Description</th>
            <th>Default</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><code>--device-id ID</code></td>
            <td>Your device ID from the app</td>
            <td>Required</td>
          </tr>
          <tr>
            <td><code>--project NAME</code></td>
            <td>Project name shown in the app. Rules are scoped per-project.</td>
            <td>Required</td>
          </tr>
          <tr>
            <td><code>--server URL</code></td>
            <td>Relay server URL</td>
            <td>https://permit.dnmfarrell.com</td>
          </tr>
        </tbody>
      </table>
      <p>The server URL can also be set via the <code>GREENLIGHT_SERVER</code> environment variable.</p>

      <h2>Using the App</h2>

      <h3>Permission Decisions</h3>
      <p>Each request can be responded to with four actions:</p>
      <ul>
        <li><strong>Always Allow</strong> — Approves and creates a rule so future matching requests are auto-approved.</li>
        <li><strong>Allow</strong> — Approves this one request.</li>
        <li><strong>Deny</strong> — Denies this one request.</li>
        <li><strong>Deny & Stop</strong> — Denies and sends a halt signal to stop the agent entirely.</li>
      </ul>

      <h3>Managing Rules</h3>
      <p>The <strong>Grants</strong> tab shows all your "Always Allow" rules grouped by project. Swipe left on any rule to delete it. Rules use pattern matching:</p>
      <ul>
        <li>Regular commands get wildcard patterns (e.g., <code>Bash(go build **)</code>)</li>
        <li>Destructive commands like <code>rm</code> use exact matching for safety</li>
        <li>File tools match on the directory (e.g., <code>Read(/home/user/src/**)</code>)</li>
      </ul>

      <h3>Notifications</h3>
      <p>Greenlight uses Time Sensitive notifications that can break through Focus modes. Make sure notifications are enabled in <strong>Settings &rarr; Greenlight &rarr; Notifications</strong> and that Time Sensitive notifications are allowed in your Focus mode settings.</p>

      <h2>Troubleshooting</h2>

      <h3>Not receiving requests</h3>
      <ul>
        <li>Check the <strong>About</strong> tab — the status should show "Connected" with a green dot.</li>
        <li>Verify your device ID in the hook config matches the one shown in the app.</li>
        <li>Make sure the hook script is executable (<code>chmod +x</code>).</li>
      </ul>

      <h3>Not receiving push notifications</h3>
      <ul>
        <li>Check that notifications are enabled: <strong>Settings &rarr; Greenlight &rarr; Notifications</strong>.</li>
        <li>If using a Focus mode, make sure Greenlight is in the allowed apps list or Time Sensitive notifications are enabled.</li>
        <li>Push notifications are sent when the app is backgrounded. If the app is in the foreground, requests arrive directly via WebSocket.</li>
      </ul>

      <h3>Requests timing out</h3>
      <ul>
        <li>The default timeout is 590 seconds (just under Claude Code's 600 second hook limit). You can adjust it with <code>--timeout SECONDS</code> in the hook config.</li>
        <li>If the app is not connected and push notifications fail, the request will time out and be denied.</li>
      </ul>

      <h2>Contact</h2>
      <p>For bug reports, feature requests, or any questions, email <a href="mailto:greenlight@dnmfarrell.com">greenlight@dnmfarrell.com</a>.</p>
    </div>
  </div>

  <footer>
    <div class="container">
      <div class="footer-links">
        <a href="privacy.html">Privacy Policy</a>
        <a href="terms.html">Terms of Service</a>
        <a href="support.html">Support</a>
        <a href="mailto:greenlight@dnmfarrell.com">Contact</a>
      </div>
      <p class="copyright">&copy; 2025-2026 David Farrell. All rights reserved.</p>
    </div>
  </footer>
</body>
</html>
